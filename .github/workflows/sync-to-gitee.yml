name: Sync to Gitee
on:
  # 触发条件：push 代码到 main/master 分支时自动同步
  push:
    branches: [ main, master ]
  # 允许手动触发同步（方便测试）
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      # 检出 GitHub 仓库的代码（拉取所有历史记录）
      - name: Checkout code from GitHub
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # 核心同步步骤：将 GitHub 代码同步到 Gitee
      - name: Sync GitHub to Gitee
        uses: wearerequired/git-mirror-action@master
        env:
          # 使用你配置的 Gitee 令牌（需提前在 GitHub Secrets 中配置）
          SSH_PRIVATE_KEY: ${{ secrets.GITEE_TOKEN }}
        with:
          # 你的 GitHub 源仓库地址（已替换为你提供的地址）
          source-repo: "git@github.com:xiyadong1/HwObs-LtOss.git"
          # 你的 Gitee 目标仓库地址（已替换为你提供的地址）
          destination-repo: "git@gitee.com:xiyadong/HwObs-LtOss.git"

      # 可选：如果你的 Gitee 仓库需要部署 Pages，保留这段；不需要则删除
      # - name: Trigger Gitee Pages Deployment
      #   uses: yanglbme/gitee-pages-action@main
      #   with:
      #     gitee-username: ${{ secrets.GITEE_USER }}  # Gitee 用户名（Secrets 中配置）
      #     gitee-password: ${{ secrets.GITEE_TOKEN }} # Gitee 令牌（Secrets 中配置）
      #     gitee-repo: xiyadong/HwObs-LtOss           # 你的 Gitee 仓库名（已替换）
      #     branch: main                               # 部署的分支（根据实际情况调整）